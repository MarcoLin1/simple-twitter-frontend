{"version":3,"sources":["webpack:///./src/views/Notifications.vue?e8a8","webpack:///./src/apis/subscribe.js","webpack:///./src/views/Notifications.vue?1344","webpack:///src/views/Notifications.vue","webpack:///./src/views/Notifications.vue?db3e","webpack:///./src/views/Notifications.vue"],"names":["add","recipientId","subscriberId","apiHelper","post","cancel","delete","data","history","id","get","getUnread","cleanUnread","put","render","_vm","this","_h","$createElement","_c","_self","staticClass","_l","notification","key","notifyId","attrs","name","params","_f","avatar","labelName","title","_v","_s","_e","content","staticRenderFns","components","mixins","notifications","computed","watch","subscribeNotifyData","handler","unshift","newValue","deep","created","getHistoryNotifications","cleanUnreadNotifications","$socket","emit","store","methods","component"],"mappings":"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","file":"js/chunk-7b901aa4.315737b7.js","sourcesContent":["export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Notifications.vue?vue&type=style&index=0&id=2c1a4e7e&lang=scss&scoped=true&\"","import { apiHelper } from '../utils/helper'\nexport default {\n  add ({ recipientId, subscriberId }) {\n    return apiHelper.post('/subscriptions', { recipientId, subscriberId })\n  },\n  cancel ({ recipientId, subscriberId }) {\n    return apiHelper.delete(`/subscriptions/${recipientId}`, { data: { subscriberId } })\n  },\n  history ({ id }) {\n    return apiHelper.get(`/notifications/${id}`)\n  },\n  getUnread ({ id }) {\n    return apiHelper.get(`/notifications/${id}/unread`)\n  },\n  cleanUnread ({ id }) {\n    return apiHelper.put(`/notifications/${id}/unread`, null)\n  }\n}\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"notifications__container\"},_vm._l((_vm.notifications),function(notification){return _c('div',{key:notification.notifyId,staticClass:\"notifications__wrapper\"},[_c('div',{staticClass:\"notifications__avatar__wrapper\"},[_c('router-link',{attrs:{\"to\":{name: 'user-tweets', params: {id: notification.id}}}},[_c('img',{staticClass:\"notifications__avatar\",attrs:{\"src\":_vm._f(\"emptyImage\")(notification.avatar),\"alt\":\"\"}})])],1),((notification.labelName === 'tweet') || (notification.title === '有新的推文通知'))?_c('div',{staticClass:\"notifications__title\"},[_vm._v(\" \"+_vm._s(notification.name + ' 有新的推文通知')+\" \")]):_vm._e(),((notification.labelName === 'follow') || (notification.title === '開始追蹤你'))?_c('div',{staticClass:\"notifications__title\"},[_vm._v(\" \"+_vm._s(notification.name + ' 開始追蹤你')+\" \")]):_vm._e(),((notification.labelName === 'reply') || (notification.title === '你的貼文有新的回覆'))?_c('div',{staticClass:\"notifications__title\"},[_vm._v(\" \"+_vm._s(notification.name + '回覆你的推文')+\" \")]):_vm._e(),((notification.labelName === 'like') || (notification.title === '喜歡你的推文'))?_c('div',{staticClass:\"notifications__title\"},[_vm._v(\" \"+_vm._s(notification.name + ' 喜歡你的貼文')+\" \")]):_vm._e(),_c('div',{staticClass:\"notifications__text\"},[_vm._v(\" \"+_vm._s(notification.content)+\" \")])])}),0)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"notifications__container\">\n    <div\n      v-for=\"notification in notifications\"\n      :key=\"notification.notifyId\"\n      class=\"notifications__wrapper\"\n    >\n      <div class=\"notifications__avatar__wrapper\">\n        <router-link :to=\"{name: 'user-tweets', params: {id: notification.id}}\">\n          <img\n            :src=\"notification.avatar | emptyImage\"\n            alt=\"\"\n            class=\"notifications__avatar\"\n          >\n        </router-link>\n      </div>\n      <div\n        v-if=\"(notification.labelName === 'tweet') || (notification.title === '有新的推文通知')\"\n        class=\"notifications__title\"\n      >\n        {{ notification.name + ' 有新的推文通知' }}\n      </div>\n      <div\n        v-if=\"(notification.labelName === 'follow') || (notification.title === '開始追蹤你')\"\n        class=\"notifications__title\"\n      >\n        {{ notification.name + ' 開始追蹤你' }}\n      </div>\n      <div\n        v-if=\"(notification.labelName === 'reply') || (notification.title === '你的貼文有新的回覆')\"\n        class=\"notifications__title\"\n      >\n        {{ notification.name + '回覆你的推文' }}\n      </div>\n      <div\n        v-if=\"(notification.labelName === 'like') || (notification.title === '喜歡你的推文')\"\n        class=\"notifications__title\"\n      >\n        {{ notification.name + ' 喜歡你的貼文' }}\n      </div>\n      <div class=\"notifications__text\">\n        {{ notification.content }}\n      </div>\n    </div>\n  </div>\n</template>\n\n<style lang=\"scss\" scoped>\n@import '../assets/scss/main.scss';\n.notifications__content{\n  margin: 50px 0;\n  @include text-style(20px, 600, $orange);\n  text-align: center;\n  width: 600px;\n}\n.notifications__container {\n  .notifications__wrapper {\n    padding: 10px 15px;\n    border-top: 1px solid $light-gray;\n    border-bottom: 1px solid $light-gray;\n    margin-bottom: -1px;\n    .notifications__avatar {\n      width: 50px;\n      height: 50px;\n      border-radius: 50%;\n    }\n    .notifications__title {\n      margin: 10px auto 10px auto;\n      font-weight: 500;\n      font-size: 0.9rem;\n    }\n    .notifications__text {\n      line-height: 1.3rem;\n      font-size: 0.8rem;\n      color: $tx-gray;\n    }\n  }\n}\n</style>\n\n<script>\nimport subscribeAPI from './../apis/subscribe'\nimport { mapState } from 'vuex'\nimport store from './../store'\nimport { emptyImageFilter } from './../utils/mixins'\n\nexport default {\n  name: 'Notifications',\n  components: {\n  },\n  mixins: [emptyImageFilter],\n  data () {\n    return {\n      notifications: []\n    }\n  },\n  computed: {\n    ...mapState(['currentUser', 'subscribeNotifyData', 'subscribeNotification'])\n  },\n  watch: {\n    subscribeNotifyData: {\n      handler: function (newValue, oldValue) {\n        this.notifications.unshift(newValue)\n      },\n      deep: true\n    }\n  },\n  created () {\n    // 取得歷史通知\n    this.getHistoryNotifications()\n\n    // 清除已讀通知\n    this.cleanUnreadNotifications()\n\n    // 發送進入通知頁面的事件\n    this.$socket.emit('enterNotify', { id: this.currentUser.id })\n\n    // 更改通知狀態\n    store.dispatch('updateSubscribeNotification')\n  },\n  methods: {\n    async getHistoryNotifications () {\n      try {\n        const { data } = await subscribeAPI.history({ id: this.currentUser.id })\n        this.notifications = data\n      } catch (e) {\n        console.log(e)\n      }\n    },\n    async cleanUnreadNotifications () {\n      try {\n        const { data } = await subscribeAPI.cleanUnread({ id: this.currentUser.id })\n        if (data.status !== 'success') {\n          throw new Error(data.message)\n        }\n      } catch (e) {\n        console.log(e)\n      }\n    }\n  }\n}\n</script>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Notifications.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Notifications.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Notifications.vue?vue&type=template&id=2c1a4e7e&scoped=true&\"\nimport script from \"./Notifications.vue?vue&type=script&lang=js&\"\nexport * from \"./Notifications.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Notifications.vue?vue&type=style&index=0&id=2c1a4e7e&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2c1a4e7e\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}